"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[8003],{4783(e,n,r){r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>i,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"2026-01-23-CompletableFuture","title":"Java\u591a\u7ebf\u7a0b\u3001\u5f02\u6b65","description":"CompletableFuture","source":"@site/javadoc/2026-01-23-CompletableFuture.md","sourceDirName":".","slug":"/java-CompletableFuture","permalink":"/docs/javadoc/java-CompletableFuture","draft":false,"unlisted":false,"editUrl":"https://github.com/LiangHChao/docs/edit/master/javadoc/2026-01-23-CompletableFuture.md","tags":[{"inline":true,"label":"CompletableFuture","permalink":"/docs/javadoc/tags/completable-future"}],"version":"current","frontMatter":{"slug":"java-CompletableFuture","title":"Java\u591a\u7ebf\u7a0b\u3001\u5f02\u6b65","authors":["lianghchao"],"tags":["CompletableFuture"]},"sidebar":"javaSidebar","previous":{"title":"Java\u5f02\u6b65\u89e3\u8026","permalink":"/docs/javadoc/java-async"}}');var u=r(4848),l=r(8453);const o={slug:"java-CompletableFuture",title:"Java\u591a\u7ebf\u7a0b\u3001\u5f02\u6b65",authors:["lianghchao"],tags:["CompletableFuture"]},a=void 0,s={},c=[{value:"CompletableFuture",id:"completablefuture",level:2},{value:"\u793a\u4f8b1: \u4f7f\u7528 supplyAsync \u521b\u5efa\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",id:"\u793a\u4f8b1-\u4f7f\u7528-supplyasync-\u521b\u5efa\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",level:3},{value:"\u793a\u4f8b2: \u4f7f\u7528 runAsync \u521b\u5efa\u65e0\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",id:"\u793a\u4f8b2-\u4f7f\u7528-runasync-\u521b\u5efa\u65e0\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",level:3},{value:"\u793a\u4f8b3: \u4f7f\u7528 completedFuture \u521b\u5efa\u5df2\u5b8c\u6210\u7684 CompletableFuture",id:"\u793a\u4f8b3-\u4f7f\u7528-completedfuture-\u521b\u5efa\u5df2\u5b8c\u6210\u7684-completablefuture",level:3},{value:"\u793a\u4f8b4: \u4f7f\u7528 thenApply \u8f6c\u6362\u7ed3\u679c",id:"\u793a\u4f8b4-\u4f7f\u7528-thenapply-\u8f6c\u6362\u7ed3\u679c",level:3},{value:"\u793a\u4f8b5: \u4f7f\u7528 thenApplyAsync \u5f02\u6b65\u8f6c\u6362\u7ed3\u679c",id:"\u793a\u4f8b5-\u4f7f\u7528-thenapplyasync-\u5f02\u6b65\u8f6c\u6362\u7ed3\u679c",level:3},{value:"\u793a\u4f8b6: \u4f7f\u7528 thenAccept \u6d88\u8d39\u7ed3\u679c\uff08\u65e0\u8fd4\u56de\u503c\uff09",id:"\u793a\u4f8b6-\u4f7f\u7528-thenaccept-\u6d88\u8d39\u7ed3\u679c\u65e0\u8fd4\u56de\u503c",level:3},{value:"\u793a\u4f8b7: \u4f7f\u7528 thenRun \u6267\u884c\u540e\u7eed\u64cd\u4f5c\uff08\u4e0d\u5173\u5fc3\u4e0a\u4e00\u6b65\u7ed3\u679c\uff09",id:"\u793a\u4f8b7-\u4f7f\u7528-thenrun-\u6267\u884c\u540e\u7eed\u64cd\u4f5c\u4e0d\u5173\u5fc3\u4e0a\u4e00\u6b65\u7ed3\u679c",level:3},{value:"\u793a\u4f8b8: \u4f7f\u7528 thenCompose \u4e32\u8054\u4e24\u4e2a\u4f9d\u8d56\u7684\u5f02\u6b65\u4efb\u52a1",id:"\u793a\u4f8b8-\u4f7f\u7528-thencompose-\u4e32\u8054\u4e24\u4e2a\u4f9d\u8d56\u7684\u5f02\u6b65\u4efb\u52a1",level:3},{value:"\u793a\u4f8b9: \u4f7f\u7528 thenCombine \u5408\u5e76\u4e24\u4e2a\u72ec\u7acb\u7684\u5f02\u6b65\u4efb\u52a1\u7ed3\u679c",id:"\u793a\u4f8b9-\u4f7f\u7528-thencombine-\u5408\u5e76\u4e24\u4e2a\u72ec\u7acb\u7684\u5f02\u6b65\u4efb\u52a1\u7ed3\u679c",level:3},{value:"\u793a\u4f8b10: \u4f7f\u7528 allOf \u7b49\u5f85\u591a\u4e2a\u4efb\u52a1\u5168\u90e8\u5b8c\u6210",id:"\u793a\u4f8b10-\u4f7f\u7528-allof-\u7b49\u5f85\u591a\u4e2a\u4efb\u52a1\u5168\u90e8\u5b8c\u6210",level:3},{value:"\u793a\u4f8b11: \u4f7f\u7528 anyOf \u7b49\u5f85\u4efb\u610f\u4e00\u4e2a\u4efb\u52a1\u5b8c\u6210",id:"\u793a\u4f8b11-\u4f7f\u7528-anyof-\u7b49\u5f85\u4efb\u610f\u4e00\u4e2a\u4efb\u52a1\u5b8c\u6210",level:3},{value:"\u793a\u4f8b12: \u4f7f\u7528 exceptionally \u5904\u7406\u5f02\u5e38",id:"\u793a\u4f8b12-\u4f7f\u7528-exceptionally-\u5904\u7406\u5f02\u5e38",level:3},{value:"\u793a\u4f8b13: \u4f7f\u7528 handle \u540c\u65f6\u5904\u7406\u6b63\u5e38\u7ed3\u679c\u548c\u5f02\u5e38",id:"\u793a\u4f8b13-\u4f7f\u7528-handle-\u540c\u65f6\u5904\u7406\u6b63\u5e38\u7ed3\u679c\u548c\u5f02\u5e38",level:3},{value:"\u793a\u4f8b14: \u4f7f\u7528 whenComplete \u6267\u884c\u5b8c\u6210\u540e\u7684\u56de\u8c03\uff08\u4e0d\u6539\u53d8\u7ed3\u679c\uff09",id:"\u793a\u4f8b14-\u4f7f\u7528-whencomplete-\u6267\u884c\u5b8c\u6210\u540e\u7684\u56de\u8c03\u4e0d\u6539\u53d8\u7ed3\u679c",level:3},{value:"\u793a\u4f8b15: \u4f7f\u7528\u8d85\u65f6\u63a7\u5236\uff08\u517c\u5bb9 Java 8\uff09",id:"\u793a\u4f8b15-\u4f7f\u7528\u8d85\u65f6\u63a7\u5236\u517c\u5bb9-java-8",level:3},{value:"\u793a\u4f8b16: \u8d85\u65f6\u8fd4\u56de\u9ed8\u8ba4\u503c\uff08\u517c\u5bb9 Java 8\uff09",id:"\u793a\u4f8b16-\u8d85\u65f6\u8fd4\u56de\u9ed8\u8ba4\u503c\u517c\u5bb9-java-8",level:3},{value:"\u793a\u4f8b17: \u590d\u6742\u4e1a\u52a1\u573a\u666f - \u8ba2\u5355\u5904\u7406\u6d41\u7a0b",id:"\u793a\u4f8b17-\u590d\u6742\u4e1a\u52a1\u573a\u666f---\u8ba2\u5355\u5904\u7406\u6d41\u7a0b",level:3},{value:"\u793a\u4f8b18: \u6279\u91cf\u6570\u636e\u5904\u7406 - \u5206\u7247\u5e76\u884c\u5904\u7406",id:"\u793a\u4f8b18-\u6279\u91cf\u6570\u636e\u5904\u7406---\u5206\u7247\u5e76\u884c\u5904\u7406",level:3},{value:"\u793a\u4f8b19: \u591a\u6570\u636e\u6e90\u805a\u5408\u67e5\u8be2",id:"\u793a\u4f8b19-\u591a\u6570\u636e\u6e90\u805a\u5408\u67e5\u8be2",level:3},{value:"\u793a\u4f8b20: \u7f13\u5b58\u7a7f\u900f\u9632\u62a4 - \u5e76\u53d1\u8bf7\u6c42\u5408\u5e76",id:"\u793a\u4f8b20-\u7f13\u5b58\u7a7f\u900f\u9632\u62a4---\u5e76\u53d1\u8bf7\u6c42\u5408\u5e76",level:3},{value:"\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801",id:"\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801",level:3}];function p(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(n.h2,{id:"completablefuture",children:"CompletableFuture"}),"\n",(0,u.jsxs)(n.ul,{children:["\n",(0,u.jsx)(n.li,{children:"CompletableFuture"}),"\n"]}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b1-\u4f7f\u7528-supplyasync-\u521b\u5efa\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",children:"\u793a\u4f8b1: \u4f7f\u7528 supplyAsync \u521b\u5efa\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b1: \u4f7f\u7528 supplyAsync \u521b\u5efa\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1\n * \n * supplyAsync \u7528\u4e8e\u6267\u884c\u6709\u8fd4\u56de\u503c\u7684\u4efb\u52a1\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u5f02\u6b65\u67e5\u8be2\u6570\u636e\u3001\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\n */\npublic CompletableFuture<String> createWithSupplyAsync() {\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6267\u884c supplyAsync \u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        // \u6a21\u62df\u8017\u65f6\u64cd\u4f5c\n        sleep(1000);\n        return "\u67e5\u8be2\u7ed3\u679c: \u7528\u6237\u4fe1\u606f";\n    }, getExecutor());\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b2-\u4f7f\u7528-runasync-\u521b\u5efa\u65e0\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1",children:"\u793a\u4f8b2: \u4f7f\u7528 runAsync \u521b\u5efa\u65e0\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b2: \u4f7f\u7528 runAsync \u521b\u5efa\u65e0\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1\n * \n * runAsync \u7528\u4e8e\u6267\u884c\u65e0\u8fd4\u56de\u503c\u7684\u4efb\u52a1\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u5f02\u6b65\u8bb0\u5f55\u65e5\u5fd7\u3001\u53d1\u9001\u901a\u77e5\n */\npublic CompletableFuture<Void> createWithRunAsync() {\n    return CompletableFuture.runAsync(() -> {\n        logger.info("\u6267\u884c runAsync \u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        // \u6a21\u62df\u8017\u65f6\u64cd\u4f5c\n        sleep(1000);\n        logger.info("\u4efb\u52a1\u6267\u884c\u5b8c\u6210");\n    }, getExecutor());\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b3-\u4f7f\u7528-completedfuture-\u521b\u5efa\u5df2\u5b8c\u6210\u7684-completablefuture",children:"\u793a\u4f8b3: \u4f7f\u7528 completedFuture \u521b\u5efa\u5df2\u5b8c\u6210\u7684 CompletableFuture"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b3: \u4f7f\u7528 completedFuture \u521b\u5efa\u5df2\u5b8c\u6210\u7684 CompletableFuture\n * \n * completedFuture \u7acb\u5373\u8fd4\u56de\u4e00\u4e2a\u5df2\u5b8c\u6210\u7684 Future\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u8fd4\u56de\u9ed8\u8ba4\u503c\u3001\u7f13\u5b58\u547d\u4e2d\u76f4\u63a5\u8fd4\u56de\n */\npublic CompletableFuture<String> createCompletedFuture() {\n    logger.info("\u521b\u5efa\u5df2\u5b8c\u6210\u7684 CompletableFuture");\n    return CompletableFuture.completedFuture("\u7acb\u5373\u8fd4\u56de\u7684\u7ed3\u679c");\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b4-\u4f7f\u7528-thenapply-\u8f6c\u6362\u7ed3\u679c",children:"\u793a\u4f8b4: \u4f7f\u7528 thenApply \u8f6c\u6362\u7ed3\u679c"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b4: \u4f7f\u7528 thenApply \u8f6c\u6362\u7ed3\u679c\n * \n * thenApply \u7528\u4e8e\u8f6c\u6362 CompletableFuture \u7684\u7ed3\u679c\uff08\u6709\u8fd4\u56de\u503c\uff09\n * \u540c\u6b65\u6267\u884c\uff0c\u5728\u4e0a\u4e00\u4e2a\u4efb\u52a1\u7684\u7ebf\u7a0b\u4e2d\u6267\u884c\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u6570\u636e\u683c\u5f0f\u8f6c\u6362\u3001\u7ed3\u679c\u5904\u7406\n */\npublic CompletableFuture<String> transformWithThenApply() {\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u7b2c\u4e00\u6b65\uff1a\u67e5\u8be2\u7528\u6237ID, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        return 10001L;\n    }, getExecutor())\n    .thenApply(userId -> {\n        logger.info("\u7b2c\u4e8c\u6b65\uff1a\u6839\u636eID\u67e5\u8be2\u7528\u6237\u540d, userId: {}, \u7ebf\u7a0b: {}", userId, Thread.currentThread().getName());\n        sleep(500);\n        return "\u7528\u6237-" + userId;\n    })\n    .thenApply(username -> {\n        logger.info("\u7b2c\u4e09\u6b65\uff1a\u683c\u5f0f\u5316\u7528\u6237\u540d, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        return "\u3010" + username + "\u3011";\n    });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b5-\u4f7f\u7528-thenapplyasync-\u5f02\u6b65\u8f6c\u6362\u7ed3\u679c",children:"\u793a\u4f8b5: \u4f7f\u7528 thenApplyAsync \u5f02\u6b65\u8f6c\u6362\u7ed3\u679c"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b5: \u4f7f\u7528 thenApplyAsync \u5f02\u6b65\u8f6c\u6362\u7ed3\u679c\n * \n * thenApplyAsync \u7528\u4e8e\u5f02\u6b65\u8f6c\u6362\u7ed3\u679c\uff08\u4f7f\u7528\u7ebf\u7a0b\u6c60\uff09\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u8f6c\u6362\u64cd\u4f5c\u6bd4\u8f83\u8017\u65f6\uff0c\u9700\u8981\u72ec\u7acb\u7ebf\u7a0b\u6267\u884c\n */\npublic CompletableFuture<String> transformWithThenApplyAsync() {\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u67e5\u8be2\u8ba2\u5355, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        return "ORDER-123456";\n    }, getExecutor())\n    .thenApplyAsync(orderId -> {\n        logger.info("\u5904\u7406\u8ba2\u5355: {}, \u7ebf\u7a0b: {}", orderId, Thread.currentThread().getName());\n        sleep(1000);\n        return "\u5904\u7406\u5b8c\u6210: " + orderId;\n    }, getExecutor());\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b6-\u4f7f\u7528-thenaccept-\u6d88\u8d39\u7ed3\u679c\u65e0\u8fd4\u56de\u503c",children:"\u793a\u4f8b6: \u4f7f\u7528 thenAccept \u6d88\u8d39\u7ed3\u679c\uff08\u65e0\u8fd4\u56de\u503c\uff09"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b6: \u4f7f\u7528 thenAccept \u6d88\u8d39\u7ed3\u679c\uff08\u65e0\u8fd4\u56de\u503c\uff09\n * \n * thenAccept \u7528\u4e8e\u6d88\u8d39\u7ed3\u679c\uff0c\u4e0d\u8fd4\u56de\u65b0\u503c\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u8bb0\u5f55\u65e5\u5fd7\u3001\u53d1\u9001\u901a\u77e5\u3001\u66f4\u65b0\u72b6\u6001\n */\npublic CompletableFuture<Void> consumeWithThenAccept() {\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u751f\u6210\u62a5\u8868, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        return "\u62a5\u8868\u6570\u636e";\n    }, getExecutor())\n    .thenAccept(report -> {\n        logger.info("\u4fdd\u5b58\u62a5\u8868: {}, \u7ebf\u7a0b: {}", report, Thread.currentThread().getName());\n        // \u4fdd\u5b58\u5230\u6570\u636e\u5e93\u6216\u6587\u4ef6\n    });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b7-\u4f7f\u7528-thenrun-\u6267\u884c\u540e\u7eed\u64cd\u4f5c\u4e0d\u5173\u5fc3\u4e0a\u4e00\u6b65\u7ed3\u679c",children:"\u793a\u4f8b7: \u4f7f\u7528 thenRun \u6267\u884c\u540e\u7eed\u64cd\u4f5c\uff08\u4e0d\u5173\u5fc3\u4e0a\u4e00\u6b65\u7ed3\u679c\uff09"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b7: \u4f7f\u7528 thenRun \u6267\u884c\u540e\u7eed\u64cd\u4f5c\uff08\u4e0d\u5173\u5fc3\u4e0a\u4e00\u6b65\u7ed3\u679c\uff09\n * \n * thenRun \u6267\u884c Runnable\uff0c\u4e0d\u63a5\u6536\u53c2\u6570\uff0c\u4e0d\u8fd4\u56de\u7ed3\u679c\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u6e05\u7406\u8d44\u6e90\u3001\u53d1\u9001\u5b8c\u6210\u901a\u77e5\n */\npublic CompletableFuture<Void> runAfterWithThenRun() {\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6267\u884c\u4e3b\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        return "\u4e3b\u4efb\u52a1\u7ed3\u679c";\n    }, getExecutor())\n    .thenRun(() -> {\n        logger.info("\u4e3b\u4efb\u52a1\u5b8c\u6210\uff0c\u6267\u884c\u6e05\u7406\u5de5\u4f5c, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n    });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b8-\u4f7f\u7528-thencompose-\u4e32\u8054\u4e24\u4e2a\u4f9d\u8d56\u7684\u5f02\u6b65\u4efb\u52a1",children:"\u793a\u4f8b8: \u4f7f\u7528 thenCompose \u4e32\u8054\u4e24\u4e2a\u4f9d\u8d56\u7684\u5f02\u6b65\u4efb\u52a1"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b8: \u4f7f\u7528 thenCompose \u4e32\u8054\u4e24\u4e2a\u4f9d\u8d56\u7684\u5f02\u6b65\u4efb\u52a1\n * \n * thenCompose \u7528\u4e8e\u4e32\u8054\u4e24\u4e2a\u6709\u4f9d\u8d56\u5173\u7cfb\u7684 CompletableFuture\n * \u7b2c\u4e8c\u4e2a\u4efb\u52a1\u4f9d\u8d56\u7b2c\u4e00\u4e2a\u4efb\u52a1\u7684\u7ed3\u679c\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u5148\u67e5\u7528\u6237ID\uff0c\u518d\u6839\u636eID\u67e5\u8ba2\u5355\n */\npublic CompletableFuture<String> combineWithThenCompose() {\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6b65\u9aa41\uff1a\u67e5\u8be2\u7528\u6237ID, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        return 10001L;\n    }, getExecutor())\n    .thenCompose(userId -> CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6b65\u9aa42\uff1a\u6839\u636e\u7528\u6237ID {} \u67e5\u8be2\u8ba2\u5355, \u7ebf\u7a0b: {}", userId, Thread.currentThread().getName());\n        sleep(1000);\n        return "\u7528\u6237 " + userId + " \u7684\u8ba2\u5355\u5217\u8868";\n    }, getExecutor()));\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b9-\u4f7f\u7528-thencombine-\u5408\u5e76\u4e24\u4e2a\u72ec\u7acb\u7684\u5f02\u6b65\u4efb\u52a1\u7ed3\u679c",children:"\u793a\u4f8b9: \u4f7f\u7528 thenCombine \u5408\u5e76\u4e24\u4e2a\u72ec\u7acb\u7684\u5f02\u6b65\u4efb\u52a1\u7ed3\u679c"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b9: \u4f7f\u7528 thenCombine \u5408\u5e76\u4e24\u4e2a\u72ec\u7acb\u7684\u5f02\u6b65\u4efb\u52a1\u7ed3\u679c\n * \n * thenCombine \u7b49\u5f85\u4e24\u4e2a\u4efb\u52a1\u90fd\u5b8c\u6210\uff0c\u7136\u540e\u5408\u5e76\u7ed3\u679c\n * \u4e24\u4e2a\u4efb\u52a1\u5e76\u884c\u6267\u884c\uff0c\u4e92\u4e0d\u4f9d\u8d56\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u540c\u65f6\u67e5\u8be2\u7528\u6237\u4fe1\u606f\u548c\u8ba2\u5355\u4fe1\u606f\uff0c\u7136\u540e\u7ec4\u88c5\n */\npublic CompletableFuture<String> combineWithThenCombine() {\n    // \u4efb\u52a11\uff1a\u67e5\u8be2\u7528\u6237\u4fe1\u606f\n    CompletableFuture<String> userFuture = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u67e5\u8be2\u7528\u6237\u4fe1\u606f, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        return "\u5f20\u4e09";\n    }, getExecutor());\n    \n    // \u4efb\u52a12\uff1a\u67e5\u8be2\u8ba2\u5355\u4fe1\u606f\n    CompletableFuture<String> orderFuture = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u67e5\u8be2\u8ba2\u5355\u4fe1\u606f, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1500);\n        return "\u8ba2\u5355-123";\n    }, getExecutor());\n    \n    // \u5408\u5e76\u4e24\u4e2a\u7ed3\u679c\n    return userFuture.thenCombine(orderFuture, (user, order) -> {\n        logger.info("\u5408\u5e76\u7ed3\u679c\uff1a\u7528\u6237={}, \u8ba2\u5355={}, \u7ebf\u7a0b: {}", user, order, Thread.currentThread().getName());\n        return String.format("\u7528\u6237 %s \u7684\u8ba2\u5355 %s", user, order);\n    });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b10-\u4f7f\u7528-allof-\u7b49\u5f85\u591a\u4e2a\u4efb\u52a1\u5168\u90e8\u5b8c\u6210",children:"\u793a\u4f8b10: \u4f7f\u7528 allOf \u7b49\u5f85\u591a\u4e2a\u4efb\u52a1\u5168\u90e8\u5b8c\u6210"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b10: \u4f7f\u7528 allOf \u7b49\u5f85\u591a\u4e2a\u4efb\u52a1\u5168\u90e8\u5b8c\u6210\n * \n * allOf \u7b49\u5f85\u6240\u6709 CompletableFuture \u5b8c\u6210\uff08\u4e0d\u5173\u5fc3\u7ed3\u679c\uff09\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u6279\u91cf\u67e5\u8be2\u3001\u5e76\u884c\u5904\u7406\u591a\u4e2a\u72ec\u7acb\u4efb\u52a1\n */\npublic CompletableFuture<List<String>> waitAllWithAllOf() {\n    // \u521b\u5efa\u591a\u4e2a\u5f02\u6b65\u4efb\u52a1\n    CompletableFuture<String> task1 = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u4efb\u52a11\u6267\u884c, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        return "\u7ed3\u679c1";\n    }, getExecutor());\n    \n    CompletableFuture<String> task2 = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u4efb\u52a12\u6267\u884c, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1500);\n        return "\u7ed3\u679c2";\n    }, getExecutor());\n    \n    CompletableFuture<String> task3 = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u4efb\u52a13\u6267\u884c, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(800);\n        return "\u7ed3\u679c3";\n    }, getExecutor());\n    \n    // \u7b49\u5f85\u6240\u6709\u4efb\u52a1\u5b8c\u6210\n    return CompletableFuture.allOf(task1, task2, task3)\n        .thenApply(v -> {\n            logger.info("\u6240\u6709\u4efb\u52a1\u5b8c\u6210\uff0c\u6536\u96c6\u7ed3\u679c");\n            // \u6536\u96c6\u6240\u6709\u7ed3\u679c\n            return Arrays.asList(\n                task1.join(),\n                task2.join(),\n                task3.join()\n            );\n        });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b11-\u4f7f\u7528-anyof-\u7b49\u5f85\u4efb\u610f\u4e00\u4e2a\u4efb\u52a1\u5b8c\u6210",children:"\u793a\u4f8b11: \u4f7f\u7528 anyOf \u7b49\u5f85\u4efb\u610f\u4e00\u4e2a\u4efb\u52a1\u5b8c\u6210"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b11: \u4f7f\u7528 anyOf \u7b49\u5f85\u4efb\u610f\u4e00\u4e2a\u4efb\u52a1\u5b8c\u6210\n * \n * anyOf \u8fd4\u56de\u6700\u5148\u5b8c\u6210\u7684\u4efb\u52a1\u7ed3\u679c\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u591a\u4e2a\u6570\u636e\u6e90\u67e5\u8be2\uff0c\u53d6\u6700\u5feb\u8fd4\u56de\u7684\u7ed3\u679c\n */\npublic CompletableFuture<String> waitAnyWithAnyOf() {\n    CompletableFuture<String> source1 = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6570\u636e\u6e901\u67e5\u8be2, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1500);\n        return "\u6570\u636e\u6e901\u7684\u7ed3\u679c";\n    }, getExecutor());\n    \n    CompletableFuture<String> source2 = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6570\u636e\u6e902\u67e5\u8be2, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(800);\n        return "\u6570\u636e\u6e902\u7684\u7ed3\u679c";\n    }, getExecutor());\n    \n    CompletableFuture<String> source3 = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6570\u636e\u6e903\u67e5\u8be2, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1200);\n        return "\u6570\u636e\u6e903\u7684\u7ed3\u679c";\n    }, getExecutor());\n    \n    // \u8fd4\u56de\u6700\u5feb\u5b8c\u6210\u7684\u7ed3\u679c\n    return CompletableFuture.anyOf(source1, source2, source3)\n        .thenApply(result -> {\n            logger.info("\u6700\u5feb\u8fd4\u56de\u7684\u7ed3\u679c: {}", result);\n            return (String) result;\n        });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b12-\u4f7f\u7528-exceptionally-\u5904\u7406\u5f02\u5e38",children:"\u793a\u4f8b12: \u4f7f\u7528 exceptionally \u5904\u7406\u5f02\u5e38"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b12: \u4f7f\u7528 exceptionally \u5904\u7406\u5f02\u5e38\n * \n * exceptionally \u6355\u83b7\u5f02\u5e38\u5e76\u8fd4\u56de\u9ed8\u8ba4\u503c\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u5f02\u5e38\u65f6\u8fd4\u56de\u515c\u5e95\u6570\u636e\n */\npublic CompletableFuture<String> handleExceptionWithExceptionally() {\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6267\u884c\u53ef\u80fd\u5931\u8d25\u7684\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(500);\n        // \u6a21\u62df\u5f02\u5e38\n        if (Math.random() > 0.5) {\n            throw new RuntimeException("\u6a21\u62df\u4e1a\u52a1\u5f02\u5e38");\n        }\n        return "\u6b63\u5e38\u7ed3\u679c";\n    }, getExecutor())\n    .exceptionally(ex -> {\n        logger.error("\u4efb\u52a1\u6267\u884c\u5931\u8d25\uff0c\u8fd4\u56de\u9ed8\u8ba4\u503c: {}", ex.getMessage());\n        return "\u9ed8\u8ba4\u503c";\n    });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b13-\u4f7f\u7528-handle-\u540c\u65f6\u5904\u7406\u6b63\u5e38\u7ed3\u679c\u548c\u5f02\u5e38",children:"\u793a\u4f8b13: \u4f7f\u7528 handle \u540c\u65f6\u5904\u7406\u6b63\u5e38\u7ed3\u679c\u548c\u5f02\u5e38"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b13: \u4f7f\u7528 handle \u540c\u65f6\u5904\u7406\u6b63\u5e38\u7ed3\u679c\u548c\u5f02\u5e38\n * \n * handle \u65e0\u8bba\u6210\u529f\u8fd8\u662f\u5931\u8d25\u90fd\u4f1a\u6267\u884c\n * \u53ef\u4ee5\u83b7\u53d6\u7ed3\u679c\u548c\u5f02\u5e38\uff0c\u8fd4\u56de\u65b0\u503c\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u9700\u8981\u7edf\u4e00\u5904\u7406\u6210\u529f\u548c\u5931\u8d25\u60c5\u51b5\n */\npublic CompletableFuture<String> handleWithHandle() {\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6267\u884c\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        if (Math.random() > 0.5) {\n            throw new RuntimeException("\u4efb\u52a1\u5931\u8d25");\n        }\n        return "\u4efb\u52a1\u6210\u529f";\n    }, getExecutor())\n    .handle((result, ex) -> {\n        if (ex != null) {\n            logger.error("\u4efb\u52a1\u6267\u884c\u5f02\u5e38: {}", ex.getMessage());\n            return "\u5f02\u5e38\u5904\u7406: " + ex.getMessage();\n        } else {\n            logger.info("\u4efb\u52a1\u6267\u884c\u6210\u529f: {}", result);\n            return "\u6210\u529f\u5904\u7406: " + result;\n        }\n    });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b14-\u4f7f\u7528-whencomplete-\u6267\u884c\u5b8c\u6210\u540e\u7684\u56de\u8c03\u4e0d\u6539\u53d8\u7ed3\u679c",children:"\u793a\u4f8b14: \u4f7f\u7528 whenComplete \u6267\u884c\u5b8c\u6210\u540e\u7684\u56de\u8c03\uff08\u4e0d\u6539\u53d8\u7ed3\u679c\uff09"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b14: \u4f7f\u7528 whenComplete \u6267\u884c\u5b8c\u6210\u540e\u7684\u56de\u8c03\uff08\u4e0d\u6539\u53d8\u7ed3\u679c\uff09\n * \n * whenComplete \u5728\u4efb\u52a1\u5b8c\u6210\u540e\u6267\u884c\uff0c\u4e0d\u6539\u53d8\u7ed3\u679c\n * \u53ef\u4ee5\u83b7\u53d6\u7ed3\u679c\u548c\u5f02\u5e38\uff0c\u4f46\u4e0d\u80fd\u8fd4\u56de\u65b0\u503c\n * \n * \u4f7f\u7528\u573a\u666f\uff1a\u8bb0\u5f55\u65e5\u5fd7\u3001\u76d1\u63a7\u7edf\u8ba1\u3001\u8d44\u6e90\u6e05\u7406\n */\npublic CompletableFuture<String> handleWithWhenComplete() {\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6267\u884c\u4e1a\u52a1\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        return "\u4e1a\u52a1\u7ed3\u679c";\n    }, getExecutor())\n    .whenComplete((result, ex) -> {\n        if (ex != null) {\n            logger.error("\u4efb\u52a1\u6267\u884c\u5931\u8d25\uff0c\u8bb0\u5f55\u65e5\u5fd7: {}", ex.getMessage());\n        } else {\n            logger.info("\u4efb\u52a1\u6267\u884c\u6210\u529f\uff0c\u8bb0\u5f55\u65e5\u5fd7: {}", result);\n        }\n    });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b15-\u4f7f\u7528\u8d85\u65f6\u63a7\u5236\u517c\u5bb9-java-8",children:"\u793a\u4f8b15: \u4f7f\u7528\u8d85\u65f6\u63a7\u5236\uff08\u517c\u5bb9 Java 8\uff09"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b15: \u4f7f\u7528\u8d85\u65f6\u63a7\u5236\uff08\u517c\u5bb9 Java 8\uff09\n *\n * \u901a\u8fc7 CompletableFuture.anyOf \u5b9e\u73b0\u8d85\u65f6\u63a7\u5236\n *\n * \u4f7f\u7528\u573a\u666f\uff1a\u9632\u6b62\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u8fc7\u957f\n */\npublic CompletableFuture<String> handleTimeout() {\n    CompletableFuture<String> taskFuture = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6267\u884c\u8017\u65f6\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(3000); // \u6a21\u62df\u8017\u65f63\u79d2\n        return "\u4efb\u52a1\u7ed3\u679c";\n    }, getExecutor());\n\n    // \u521b\u5efa\u8d85\u65f6Future\n    CompletableFuture<String> timeoutFuture = new CompletableFuture<>();\n    ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);\n    scheduler.schedule(() -> {\n        timeoutFuture.completeExceptionally(new TimeoutException("\u4efb\u52a1\u6267\u884c\u8d85\u65f6"));\n        scheduler.shutdown();\n    }, 2, TimeUnit.SECONDS);\n\n    // \u8fd4\u56de\u6700\u5148\u5b8c\u6210\u7684\n    return CompletableFuture.anyOf(taskFuture, timeoutFuture)\n        .thenApply(result -> (String) result)\n        .exceptionally(ex -> {\n            logger.error("\u4efb\u52a1\u8d85\u65f6: {}", ex.getMessage());\n            return "\u8d85\u65f6\u9ed8\u8ba4\u503c";\n        });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b16-\u8d85\u65f6\u8fd4\u56de\u9ed8\u8ba4\u503c\u517c\u5bb9-java-8",children:"\u793a\u4f8b16: \u8d85\u65f6\u8fd4\u56de\u9ed8\u8ba4\u503c\uff08\u517c\u5bb9 Java 8\uff09"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b16: \u8d85\u65f6\u8fd4\u56de\u9ed8\u8ba4\u503c\uff08\u517c\u5bb9 Java 8\uff09\n *\n * \u8d85\u65f6\u540e\u8fd4\u56de\u9ed8\u8ba4\u503c\uff0c\u4e0d\u629b\u5f02\u5e38\n *\n * \u4f7f\u7528\u573a\u666f\uff1a\u8d85\u65f6\u540e\u4f7f\u7528\u515c\u5e95\u6570\u636e\n */\npublic CompletableFuture<String> handleTimeoutWithDefault() {\n    CompletableFuture<String> taskFuture = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6267\u884c\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(3000);\n        return "\u6b63\u5e38\u7ed3\u679c";\n    }, getExecutor());\n\n    // \u521b\u5efa\u8d85\u65f6Future\uff0c\u8d85\u65f6\u540e\u5b8c\u6210\u5e76\u8fd4\u56de\u9ed8\u8ba4\u503c\n    CompletableFuture<String> timeoutFuture = new CompletableFuture<>();\n    ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);\n    scheduler.schedule(() -> {\n        timeoutFuture.complete("\u8d85\u65f6\u9ed8\u8ba4\u7ed3\u679c");\n        scheduler.shutdown();\n    }, 2, TimeUnit.SECONDS);\n\n    // \u8fd4\u56de\u6700\u5148\u5b8c\u6210\u7684\n    return CompletableFuture.anyOf(taskFuture, timeoutFuture)\n        .thenApply(result -> {\n            logger.info("\u8fd4\u56de\u7ed3\u679c: {}", result);\n            return (String) result;\n        });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b17-\u590d\u6742\u4e1a\u52a1\u573a\u666f---\u8ba2\u5355\u5904\u7406\u6d41\u7a0b",children:"\u793a\u4f8b17: \u590d\u6742\u4e1a\u52a1\u573a\u666f - \u8ba2\u5355\u5904\u7406\u6d41\u7a0b"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b17: \u590d\u6742\u4e1a\u52a1\u573a\u666f - \u8ba2\u5355\u5904\u7406\u6d41\u7a0b\n * \n * \u573a\u666f\uff1a\u521b\u5efa\u8ba2\u5355\u9700\u8981\uff1a\n * 1. \u6821\u9a8c\u5e93\u5b58\uff08\u5e76\u884c\uff09\n * 2. \u6821\u9a8c\u7528\u6237\u79ef\u5206\uff08\u5e76\u884c\uff09\n * 3. \u521b\u5efa\u8ba2\u5355\uff08\u4f9d\u8d561\u30012\uff09\n * 4. \u6263\u51cf\u5e93\u5b58\uff08\u4f9d\u8d563\uff09\n * 5. \u6263\u51cf\u79ef\u5206\uff08\u4f9d\u8d563\uff09\n * 6. \u53d1\u9001\u901a\u77e5\uff08\u4f9d\u8d563\uff09\n */\npublic CompletableFuture<String> complexOrderProcess(Long userId, Long productId, Integer quantity) {\n    logger.info("\u5f00\u59cb\u5904\u7406\u8ba2\u5355\uff1a\u7528\u6237={}, \u5546\u54c1={}, \u6570\u91cf={}", userId, productId, quantity);\n    \n    // \u6b65\u9aa41\uff1a\u5e76\u884c\u6821\u9a8c\u5e93\u5b58\u548c\u79ef\u5206\n    CompletableFuture<Boolean> checkInventory = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6821\u9a8c\u5e93\u5b58, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(500);\n        return true; // \u5e93\u5b58\u5145\u8db3\n    }, getExecutor());\n    \n    CompletableFuture<Boolean> checkPoints = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u6821\u9a8c\u79ef\u5206, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(600);\n        return true; // \u79ef\u5206\u5145\u8db3\n    }, getExecutor());\n    \n    // \u6b65\u9aa42\uff1a\u7b49\u5f85\u6821\u9a8c\u5b8c\u6210\uff0c\u521b\u5efa\u8ba2\u5355\n    return CompletableFuture.allOf(checkInventory, checkPoints)\n        .thenCompose(v -> {\n            if (!checkInventory.join() || !checkPoints.join()) {\n                return CompletableFuture.completedFuture("\u8ba2\u5355\u521b\u5efa\u5931\u8d25\uff1a\u5e93\u5b58\u6216\u79ef\u5206\u4e0d\u8db3");\n            }\n            \n            return CompletableFuture.supplyAsync(() -> {\n                logger.info("\u521b\u5efa\u8ba2\u5355, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n                sleep(800);\n                return "ORDER-" + System.currentTimeMillis();\n            }, getExecutor());\n        })\n        // \u6b65\u9aa43\uff1a\u5e76\u884c\u6263\u51cf\u5e93\u5b58\u548c\u79ef\u5206\n        .thenCompose(orderId -> {\n            if (orderId.startsWith("\u8ba2\u5355\u521b\u5efa\u5931\u8d25")) {\n                return CompletableFuture.completedFuture(orderId);\n            }\n            \n            CompletableFuture<Void> deductInventory = CompletableFuture.runAsync(() -> {\n                logger.info("\u6263\u51cf\u5e93\u5b58\uff0c\u8ba2\u5355: {}, \u7ebf\u7a0b: {}", orderId, Thread.currentThread().getName());\n                sleep(400);\n            }, getExecutor());\n            \n            CompletableFuture<Void> deductPoints = CompletableFuture.runAsync(() -> {\n                logger.info("\u6263\u51cf\u79ef\u5206\uff0c\u8ba2\u5355: {}, \u7ebf\u7a0b: {}", orderId, Thread.currentThread().getName());\n                sleep(500);\n            }, getExecutor());\n            \n            return CompletableFuture.allOf(deductInventory, deductPoints)\n                .thenApply(v -> orderId);\n        })\n        // \u6b65\u9aa44\uff1a\u53d1\u9001\u901a\u77e5\n        .thenApply(orderId -> {\n            if (!orderId.startsWith("\u8ba2\u5355\u521b\u5efa\u5931\u8d25")) {\n                CompletableFuture.runAsync(() -> {\n                    logger.info("\u53d1\u9001\u8ba2\u5355\u901a\u77e5\uff0c\u8ba2\u5355: {}, \u7ebf\u7a0b: {}", orderId, Thread.currentThread().getName());\n                }, getExecutor());\n            }\n            return orderId;\n        })\n        // \u6b65\u9aa45\uff1a\u5f02\u5e38\u5904\u7406\n        .exceptionally(ex -> {\n            logger.error("\u8ba2\u5355\u5904\u7406\u5931\u8d25: {}", ex.getMessage(), ex);\n            return "\u8ba2\u5355\u5904\u7406\u5f02\u5e38: " + ex.getMessage();\n        })\n        // \u6b65\u9aa46\uff1a\u5b8c\u6210\u56de\u8c03\n        .whenComplete((result, ex) -> {\n            if (ex == null) {\n                logger.info("\u8ba2\u5355\u5904\u7406\u5b8c\u6210: {}", result);\n            }\n        });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b18-\u6279\u91cf\u6570\u636e\u5904\u7406---\u5206\u7247\u5e76\u884c\u5904\u7406",children:"\u793a\u4f8b18: \u6279\u91cf\u6570\u636e\u5904\u7406 - \u5206\u7247\u5e76\u884c\u5904\u7406"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b18: \u6279\u91cf\u6570\u636e\u5904\u7406 - \u5206\u7247\u5e76\u884c\u5904\u7406\n * \n * \u573a\u666f\uff1a\u5904\u740610000\u6761\u6570\u636e\uff0c\u520610\u6279\uff0c\u6bcf\u62791000\u6761\u5e76\u884c\u5904\u7406\n */\npublic CompletableFuture<Integer> batchProcess(List<Long> dataIds) {\n    logger.info("\u5f00\u59cb\u6279\u91cf\u5904\u7406\uff0c\u603b\u6570: {}", dataIds.size());\n    \n    // \u5206\u7247\uff1a\u6bcf\u62791000\u6761\n    int batchSize = 1000;\n    List<List<Long>> batches = partition(dataIds, batchSize);\n    \n    // \u4e3a\u6bcf\u4e00\u6279\u521b\u5efa\u5f02\u6b65\u4efb\u52a1\n    List<CompletableFuture<Integer>> futures = batches.stream()\n        .map(batch -> CompletableFuture.supplyAsync(() -> {\n            logger.info("\u5904\u7406\u6279\u6b21\uff0c\u6570\u91cf: {}, \u7ebf\u7a0b: {}", batch.size(), Thread.currentThread().getName());\n            sleep(1000); // \u6a21\u62df\u5904\u7406\n            return batch.size();\n        }, getExecutor()))\n        .collect(Collectors.toList());\n    \n    // \u7b49\u5f85\u6240\u6709\u6279\u6b21\u5b8c\u6210\uff0c\u6c47\u603b\u7ed3\u679c\n    return CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]))\n        .thenApply(v -> {\n            int total = futures.stream()\n                .mapToInt(CompletableFuture::join)\n                .sum();\n            logger.info("\u6279\u91cf\u5904\u7406\u5b8c\u6210\uff0c\u603b\u5904\u7406\u6570: {}", total);\n            return total;\n        })\n        .exceptionally(ex -> {\n            logger.error("\u6279\u91cf\u5904\u7406\u5931\u8d25: {}", ex.getMessage(), ex);\n            return 0;\n        });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b19-\u591a\u6570\u636e\u6e90\u805a\u5408\u67e5\u8be2",children:"\u793a\u4f8b19: \u591a\u6570\u636e\u6e90\u805a\u5408\u67e5\u8be2"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b19: \u591a\u6570\u636e\u6e90\u805a\u5408\u67e5\u8be2\n * \n * \u573a\u666f\uff1a\u540c\u65f6\u67e5\u8be2\u7528\u6237\u4fe1\u606f\u3001\u8ba2\u5355\u5217\u8868\u3001\u6536\u85cf\u5546\u54c1\uff0c\u7ec4\u88c5\u6210\u9996\u9875\u6570\u636e\n */\npublic CompletableFuture<String> aggregateUserData(Long userId) {\n    logger.info("\u805a\u5408\u67e5\u8be2\u7528\u6237\u6570\u636e: {}", userId);\n    \n    // \u5e76\u884c\u67e5\u8be2\u591a\u4e2a\u6570\u636e\u6e90\n    CompletableFuture<String> userInfo = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u67e5\u8be2\u7528\u6237\u4fe1\u606f, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(800);\n        return "\u7528\u6237\u4fe1\u606f";\n    }, getExecutor());\n    \n    CompletableFuture<String> orderList = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u67e5\u8be2\u8ba2\u5355\u5217\u8868, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1200);\n        return "\u8ba2\u5355\u5217\u8868";\n    }, getExecutor());\n    \n    CompletableFuture<String> favorites = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u67e5\u8be2\u6536\u85cf\u5546\u54c1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(600);\n        return "\u6536\u85cf\u5546\u54c1";\n    }, getExecutor());\n    \n    CompletableFuture<String> recommendations = CompletableFuture.supplyAsync(() -> {\n        logger.info("\u67e5\u8be2\u63a8\u8350\u5546\u54c1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(1000);\n        return "\u63a8\u8350\u5546\u54c1";\n    }, getExecutor());\n    \n    // \u805a\u5408\u6240\u6709\u7ed3\u679c\n    return CompletableFuture.allOf(userInfo, orderList, favorites, recommendations)\n        .thenApply(v -> {\n            String result = String.format("\u9996\u9875\u6570\u636e: {\u7528\u6237: %s, \u8ba2\u5355: %s, \u6536\u85cf: %s, \u63a8\u8350: %s}",\n                userInfo.join(), orderList.join(), favorites.join(), recommendations.join());\n            logger.info("\u6570\u636e\u805a\u5408\u5b8c\u6210");\n            return result;\n        })\n        .exceptionally(ex -> {\n            logger.error("\u6570\u636e\u805a\u5408\u5931\u8d25: {}", ex.getMessage());\n            return "\u6570\u636e\u52a0\u8f7d\u5931\u8d25";\n        });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u793a\u4f8b20-\u7f13\u5b58\u7a7f\u900f\u9632\u62a4---\u5e76\u53d1\u8bf7\u6c42\u5408\u5e76",children:"\u793a\u4f8b20: \u7f13\u5b58\u7a7f\u900f\u9632\u62a4 - \u5e76\u53d1\u8bf7\u6c42\u5408\u5e76"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'/**\n * \u793a\u4f8b20: \u7f13\u5b58\u7a7f\u900f\u9632\u62a4 - \u5e76\u53d1\u8bf7\u6c42\u5408\u5e76\n * \n * \u573a\u666f\uff1a\u591a\u4e2a\u8bf7\u6c42\u540c\u65f6\u67e5\u8be2\u540c\u4e00\u4e2akey\uff0c\u53ea\u6267\u884c\u4e00\u6b21\u6570\u636e\u5e93\u67e5\u8be2\n */\npublic CompletableFuture<Object> getDataWithCache(String key) {\n    logger.info("\u67e5\u8be2\u6570\u636e\uff0ckey: {}", key);\n    \n    // \u6a21\u62df\uff1a\u5148\u67e5\u7f13\u5b58\n    return CompletableFuture.supplyAsync(() -> {\n        logger.info("\u67e5\u8be2\u7f13\u5b58, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        sleep(100);\n        return null; // \u7f13\u5b58\u672a\u547d\u4e2d\n    }, getExecutor())\n    .thenCompose(cacheData -> {\n        if (cacheData != null) {\n            logger.info("\u7f13\u5b58\u547d\u4e2d: {}", cacheData);\n            return CompletableFuture.completedFuture(cacheData);\n        }\n        \n        // \u7f13\u5b58\u672a\u547d\u4e2d\uff0c\u67e5\u8be2\u6570\u636e\u5e93\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u7f13\u5b58\u672a\u547d\u4e2d\uff0c\u67e5\u8be2\u6570\u636e\u5e93, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1500); // \u6a21\u62df\u6570\u636e\u5e93\u67e5\u8be2\n            String dbData = "DB\u6570\u636e-" + key;\n            \n            // \u5f02\u6b65\u66f4\u65b0\u7f13\u5b58\uff08\u4e0d\u963b\u585e\u4e3b\u6d41\u7a0b\uff09\n            CompletableFuture.runAsync(() -> {\n                logger.info("\u66f4\u65b0\u7f13\u5b58, key: {}", key);\n                sleep(200);\n            }, getExecutor());\n            \n            return dbData;\n        }, getExecutor());\n    })\n    .exceptionally(ex -> {\n        logger.error("\u67e5\u8be2\u5931\u8d25: {}", ex.getMessage());\n        return "\u9ed8\u8ba4\u503c";\n    });\n}\n'})}),"\n",(0,u.jsx)(n.h3,{id:"\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801",children:"\u5b8c\u6574\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,u.jsx)(n.pre,{children:(0,u.jsx)(n.code,{className:"language-java",children:'import com.ruoyi.common.utils.spring.SpringUtils;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;\nimport org.springframework.stereotype.Component;\n\nimport javax.annotation.PreDestroy;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.concurrent.*;\nimport java.util.stream.Collectors;\n\n/**\n * CompletableFuture \u4f7f\u7528\u793a\u4f8b\n * \n * CompletableFuture \u662f Java 8 \u5f15\u5165\u7684\u5f02\u6b65\u7f16\u7a0b\u5de5\u5177\uff0c\u652f\u6301\uff1a\n * 1. \u5f02\u6b65\u4efb\u52a1\u6267\u884c\n * 2. \u4efb\u52a1\u7ed3\u679c\u8f6c\u6362\n * 3. \u591a\u4efb\u52a1\u7ec4\u5408\n * 4. \u5f02\u5e38\u5904\u7406\n * 5. \u8d85\u65f6\u63a7\u5236\n * \n * @author ruoyi\n */\n@Component\npublic class CompletableFutureExample {\n    \n    private static final Logger logger = LoggerFactory.getLogger(CompletableFutureExample.class);\n    \n    /**\n     * \u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60\uff08\u5f53\u9879\u76ee\u672a\u914d\u7f6e\u65f6\u4f7f\u7528\uff09\n     */\n    private volatile ExecutorService customExecutor;\n    \n    /**\n     * \u83b7\u53d6\u7ebf\u7a0b\u6c60\u6267\u884c\u5668\n     * \u4f18\u5148\u4f7f\u7528\u9879\u76ee\u914d\u7f6e\u7684\u7ebf\u7a0b\u6c60\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u521b\u5efa\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60\n     */\n    private Executor getExecutor() {\n        try {\n            // \u5c1d\u8bd5\u83b7\u53d6\u9879\u76ee\u914d\u7f6e\u7684\u7ebf\u7a0b\u6c60\n            if (SpringUtils.containsBean("threadPoolTaskExecutor")) {\n                ThreadPoolTaskExecutor bean = SpringUtils.getBean("threadPoolTaskExecutor");\n                if (bean != null) {\n                    return bean.getThreadPoolExecutor();\n                }\n            }\n        } catch (Exception e) {\n            logger.warn("\u672a\u627e\u5230\u9879\u76ee\u914d\u7f6e\u7684\u7ebf\u7a0b\u6c60\uff0c\u4f7f\u7528\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60");\n        }\n        \n        // \u53cc\u91cd\u68c0\u67e5\u9501\u521b\u5efa\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60\n        if (customExecutor == null) {\n            synchronized (this) {\n                if (customExecutor == null) {\n                    customExecutor = createCustomExecutor();\n                    logger.info("\u521b\u5efa\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60\u5b8c\u6210");\n                }\n            }\n        }\n        return customExecutor;\n    }\n    \n    /**\n     * \u521b\u5efa\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60\n     */\n    private ExecutorService createCustomExecutor() {\n        int corePoolSize = Runtime.getRuntime().availableProcessors();\n        int maxPoolSize = corePoolSize * 2;\n        long keepAliveTime = 60L;\n        int queueCapacity = 1000;\n        \n        ThreadPoolExecutor executor = new ThreadPoolExecutor(\n            corePoolSize,\n            maxPoolSize,\n            keepAliveTime,\n            TimeUnit.SECONDS,\n            new LinkedBlockingQueue<>(queueCapacity),\n            new ThreadFactory() {\n                private int count = 0;\n                @Override\n                public Thread newThread(Runnable r) {\n                    Thread thread = new Thread(r, "CompletableFuture-" + (++count));\n                    thread.setDaemon(false);\n                    return thread;\n                }\n            },\n            new ThreadPoolExecutor.CallerRunsPolicy()\n        );\n        \n        return executor;\n    }\n    \n    /**\n     * \u5e94\u7528\u5173\u95ed\u65f6\u6e05\u7406\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60\n     */\n    @PreDestroy\n    public void destroy() {\n        if (customExecutor != null && !customExecutor.isShutdown()) {\n            logger.info("\u5173\u95ed\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60");\n            customExecutor.shutdown();\n            try {\n                if (!customExecutor.awaitTermination(60, TimeUnit.SECONDS)) {\n                    customExecutor.shutdownNow();\n                    if (!customExecutor.awaitTermination(60, TimeUnit.SECONDS)) {\n                        logger.error("\u7ebf\u7a0b\u6c60\u672a\u80fd\u6b63\u5e38\u5173\u95ed");\n                    }\n                }\n            } catch (InterruptedException e) {\n                customExecutor.shutdownNow();\n                Thread.currentThread().interrupt();\n            }\n        }\n    }\n    \n    // ==================== \u4e00\u3001\u521b\u5efa CompletableFuture ====================\n    \n    /**\n     * \u793a\u4f8b1: \u4f7f\u7528 supplyAsync \u521b\u5efa\u6709\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1\n     * \n     * supplyAsync \u7528\u4e8e\u6267\u884c\u6709\u8fd4\u56de\u503c\u7684\u4efb\u52a1\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u5f02\u6b65\u67e5\u8be2\u6570\u636e\u3001\u8c03\u7528\u8fdc\u7a0b\u670d\u52a1\n     */\n    public CompletableFuture<String> createWithSupplyAsync() {\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6267\u884c supplyAsync \u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            // \u6a21\u62df\u8017\u65f6\u64cd\u4f5c\n            sleep(1000);\n            return "\u67e5\u8be2\u7ed3\u679c: \u7528\u6237\u4fe1\u606f";\n        }, getExecutor());\n    }\n    \n    /**\n     * \u793a\u4f8b2: \u4f7f\u7528 runAsync \u521b\u5efa\u65e0\u8fd4\u56de\u503c\u7684\u5f02\u6b65\u4efb\u52a1\n     * \n     * runAsync \u7528\u4e8e\u6267\u884c\u65e0\u8fd4\u56de\u503c\u7684\u4efb\u52a1\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u5f02\u6b65\u8bb0\u5f55\u65e5\u5fd7\u3001\u53d1\u9001\u901a\u77e5\n     */\n    public CompletableFuture<Void> createWithRunAsync() {\n        return CompletableFuture.runAsync(() -> {\n            logger.info("\u6267\u884c runAsync \u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            // \u6a21\u62df\u8017\u65f6\u64cd\u4f5c\n            sleep(1000);\n            logger.info("\u4efb\u52a1\u6267\u884c\u5b8c\u6210");\n        }, getExecutor());\n    }\n    \n    /**\n     * \u793a\u4f8b3: \u4f7f\u7528 completedFuture \u521b\u5efa\u5df2\u5b8c\u6210\u7684 CompletableFuture\n     * \n     * completedFuture \u7acb\u5373\u8fd4\u56de\u4e00\u4e2a\u5df2\u5b8c\u6210\u7684 Future\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u8fd4\u56de\u9ed8\u8ba4\u503c\u3001\u7f13\u5b58\u547d\u4e2d\u76f4\u63a5\u8fd4\u56de\n     */\n    public CompletableFuture<String> createCompletedFuture() {\n        logger.info("\u521b\u5efa\u5df2\u5b8c\u6210\u7684 CompletableFuture");\n        return CompletableFuture.completedFuture("\u7acb\u5373\u8fd4\u56de\u7684\u7ed3\u679c");\n    }\n    \n    // ==================== \u4e8c\u3001\u7ed3\u679c\u8f6c\u6362 ====================\n    \n    /**\n     * \u793a\u4f8b4: \u4f7f\u7528 thenApply \u8f6c\u6362\u7ed3\u679c\n     * \n     * thenApply \u7528\u4e8e\u8f6c\u6362 CompletableFuture \u7684\u7ed3\u679c\uff08\u6709\u8fd4\u56de\u503c\uff09\n     * \u540c\u6b65\u6267\u884c\uff0c\u5728\u4e0a\u4e00\u4e2a\u4efb\u52a1\u7684\u7ebf\u7a0b\u4e2d\u6267\u884c\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u6570\u636e\u683c\u5f0f\u8f6c\u6362\u3001\u7ed3\u679c\u5904\u7406\n     */\n    public CompletableFuture<String> transformWithThenApply() {\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u7b2c\u4e00\u6b65\uff1a\u67e5\u8be2\u7528\u6237ID, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            return 10001L;\n        }, getExecutor())\n        .thenApply(userId -> {\n            logger.info("\u7b2c\u4e8c\u6b65\uff1a\u6839\u636eID\u67e5\u8be2\u7528\u6237\u540d, userId: {}, \u7ebf\u7a0b: {}", userId, Thread.currentThread().getName());\n            sleep(500);\n            return "\u7528\u6237-" + userId;\n        })\n        .thenApply(username -> {\n            logger.info("\u7b2c\u4e09\u6b65\uff1a\u683c\u5f0f\u5316\u7528\u6237\u540d, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            return "\u3010" + username + "\u3011";\n        });\n    }\n    \n    /**\n     * \u793a\u4f8b5: \u4f7f\u7528 thenApplyAsync \u5f02\u6b65\u8f6c\u6362\u7ed3\u679c\n     * \n     * thenApplyAsync \u7528\u4e8e\u5f02\u6b65\u8f6c\u6362\u7ed3\u679c\uff08\u4f7f\u7528\u7ebf\u7a0b\u6c60\uff09\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u8f6c\u6362\u64cd\u4f5c\u6bd4\u8f83\u8017\u65f6\uff0c\u9700\u8981\u72ec\u7acb\u7ebf\u7a0b\u6267\u884c\n     */\n    public CompletableFuture<String> transformWithThenApplyAsync() {\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u67e5\u8be2\u8ba2\u5355, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            return "ORDER-123456";\n        }, getExecutor())\n        .thenApplyAsync(orderId -> {\n            logger.info("\u5904\u7406\u8ba2\u5355: {}, \u7ebf\u7a0b: {}", orderId, Thread.currentThread().getName());\n            sleep(1000);\n            return "\u5904\u7406\u5b8c\u6210: " + orderId;\n        }, getExecutor());\n    }\n    \n    /**\n     * \u793a\u4f8b6: \u4f7f\u7528 thenAccept \u6d88\u8d39\u7ed3\u679c\uff08\u65e0\u8fd4\u56de\u503c\uff09\n     * \n     * thenAccept \u7528\u4e8e\u6d88\u8d39\u7ed3\u679c\uff0c\u4e0d\u8fd4\u56de\u65b0\u503c\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u8bb0\u5f55\u65e5\u5fd7\u3001\u53d1\u9001\u901a\u77e5\u3001\u66f4\u65b0\u72b6\u6001\n     */\n    public CompletableFuture<Void> consumeWithThenAccept() {\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u751f\u6210\u62a5\u8868, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            return "\u62a5\u8868\u6570\u636e";\n        }, getExecutor())\n        .thenAccept(report -> {\n            logger.info("\u4fdd\u5b58\u62a5\u8868: {}, \u7ebf\u7a0b: {}", report, Thread.currentThread().getName());\n            // \u4fdd\u5b58\u5230\u6570\u636e\u5e93\u6216\u6587\u4ef6\n        });\n    }\n    \n    /**\n     * \u793a\u4f8b7: \u4f7f\u7528 thenRun \u6267\u884c\u540e\u7eed\u64cd\u4f5c\uff08\u4e0d\u5173\u5fc3\u4e0a\u4e00\u6b65\u7ed3\u679c\uff09\n     * \n     * thenRun \u6267\u884c Runnable\uff0c\u4e0d\u63a5\u6536\u53c2\u6570\uff0c\u4e0d\u8fd4\u56de\u7ed3\u679c\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u6e05\u7406\u8d44\u6e90\u3001\u53d1\u9001\u5b8c\u6210\u901a\u77e5\n     */\n    public CompletableFuture<Void> runAfterWithThenRun() {\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6267\u884c\u4e3b\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            return "\u4e3b\u4efb\u52a1\u7ed3\u679c";\n        }, getExecutor())\n        .thenRun(() -> {\n            logger.info("\u4e3b\u4efb\u52a1\u5b8c\u6210\uff0c\u6267\u884c\u6e05\u7406\u5de5\u4f5c, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n        });\n    }\n    \n    // ==================== \u4e09\u3001\u7ec4\u5408\u591a\u4e2a CompletableFuture ====================\n    \n    /**\n     * \u793a\u4f8b8: \u4f7f\u7528 thenCompose \u4e32\u8054\u4e24\u4e2a\u4f9d\u8d56\u7684\u5f02\u6b65\u4efb\u52a1\n     * \n     * thenCompose \u7528\u4e8e\u4e32\u8054\u4e24\u4e2a\u6709\u4f9d\u8d56\u5173\u7cfb\u7684 CompletableFuture\n     * \u7b2c\u4e8c\u4e2a\u4efb\u52a1\u4f9d\u8d56\u7b2c\u4e00\u4e2a\u4efb\u52a1\u7684\u7ed3\u679c\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u5148\u67e5\u7528\u6237ID\uff0c\u518d\u6839\u636eID\u67e5\u8ba2\u5355\n     */\n    public CompletableFuture<String> combineWithThenCompose() {\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6b65\u9aa41\uff1a\u67e5\u8be2\u7528\u6237ID, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            return 10001L;\n        }, getExecutor())\n        .thenCompose(userId -> CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6b65\u9aa42\uff1a\u6839\u636e\u7528\u6237ID {} \u67e5\u8be2\u8ba2\u5355, \u7ebf\u7a0b: {}", userId, Thread.currentThread().getName());\n            sleep(1000);\n            return "\u7528\u6237 " + userId + " \u7684\u8ba2\u5355\u5217\u8868";\n        }, getExecutor()));\n    }\n    \n    /**\n     * \u793a\u4f8b9: \u4f7f\u7528 thenCombine \u5408\u5e76\u4e24\u4e2a\u72ec\u7acb\u7684\u5f02\u6b65\u4efb\u52a1\u7ed3\u679c\n     * \n     * thenCombine \u7b49\u5f85\u4e24\u4e2a\u4efb\u52a1\u90fd\u5b8c\u6210\uff0c\u7136\u540e\u5408\u5e76\u7ed3\u679c\n     * \u4e24\u4e2a\u4efb\u52a1\u5e76\u884c\u6267\u884c\uff0c\u4e92\u4e0d\u4f9d\u8d56\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u540c\u65f6\u67e5\u8be2\u7528\u6237\u4fe1\u606f\u548c\u8ba2\u5355\u4fe1\u606f\uff0c\u7136\u540e\u7ec4\u88c5\n     */\n    public CompletableFuture<String> combineWithThenCombine() {\n        // \u4efb\u52a11\uff1a\u67e5\u8be2\u7528\u6237\u4fe1\u606f\n        CompletableFuture<String> userFuture = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u67e5\u8be2\u7528\u6237\u4fe1\u606f, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            return "\u5f20\u4e09";\n        }, getExecutor());\n        \n        // \u4efb\u52a12\uff1a\u67e5\u8be2\u8ba2\u5355\u4fe1\u606f\n        CompletableFuture<String> orderFuture = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u67e5\u8be2\u8ba2\u5355\u4fe1\u606f, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1500);\n            return "\u8ba2\u5355-123";\n        }, getExecutor());\n        \n        // \u5408\u5e76\u4e24\u4e2a\u7ed3\u679c\n        return userFuture.thenCombine(orderFuture, (user, order) -> {\n            logger.info("\u5408\u5e76\u7ed3\u679c\uff1a\u7528\u6237={}, \u8ba2\u5355={}, \u7ebf\u7a0b: {}", user, order, Thread.currentThread().getName());\n            return String.format("\u7528\u6237 %s \u7684\u8ba2\u5355 %s", user, order);\n        });\n    }\n    \n    /**\n     * \u793a\u4f8b10: \u4f7f\u7528 allOf \u7b49\u5f85\u591a\u4e2a\u4efb\u52a1\u5168\u90e8\u5b8c\u6210\n     * \n     * allOf \u7b49\u5f85\u6240\u6709 CompletableFuture \u5b8c\u6210\uff08\u4e0d\u5173\u5fc3\u7ed3\u679c\uff09\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u6279\u91cf\u67e5\u8be2\u3001\u5e76\u884c\u5904\u7406\u591a\u4e2a\u72ec\u7acb\u4efb\u52a1\n     */\n    public CompletableFuture<List<String>> waitAllWithAllOf() {\n        // \u521b\u5efa\u591a\u4e2a\u5f02\u6b65\u4efb\u52a1\n        CompletableFuture<String> task1 = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u4efb\u52a11\u6267\u884c, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            return "\u7ed3\u679c1";\n        }, getExecutor());\n        \n        CompletableFuture<String> task2 = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u4efb\u52a12\u6267\u884c, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1500);\n            return "\u7ed3\u679c2";\n        }, getExecutor());\n        \n        CompletableFuture<String> task3 = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u4efb\u52a13\u6267\u884c, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(800);\n            return "\u7ed3\u679c3";\n        }, getExecutor());\n        \n        // \u7b49\u5f85\u6240\u6709\u4efb\u52a1\u5b8c\u6210\n        return CompletableFuture.allOf(task1, task2, task3)\n            .thenApply(v -> {\n                logger.info("\u6240\u6709\u4efb\u52a1\u5b8c\u6210\uff0c\u6536\u96c6\u7ed3\u679c");\n                // \u6536\u96c6\u6240\u6709\u7ed3\u679c\n                return Arrays.asList(\n                    task1.join(),\n                    task2.join(),\n                    task3.join()\n                );\n            });\n    }\n    \n    /**\n     * \u793a\u4f8b11: \u4f7f\u7528 anyOf \u7b49\u5f85\u4efb\u610f\u4e00\u4e2a\u4efb\u52a1\u5b8c\u6210\n     * \n     * anyOf \u8fd4\u56de\u6700\u5148\u5b8c\u6210\u7684\u4efb\u52a1\u7ed3\u679c\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u591a\u4e2a\u6570\u636e\u6e90\u67e5\u8be2\uff0c\u53d6\u6700\u5feb\u8fd4\u56de\u7684\u7ed3\u679c\n     */\n    public CompletableFuture<String> waitAnyWithAnyOf() {\n        CompletableFuture<String> source1 = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6570\u636e\u6e901\u67e5\u8be2, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1500);\n            return "\u6570\u636e\u6e901\u7684\u7ed3\u679c";\n        }, getExecutor());\n        \n        CompletableFuture<String> source2 = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6570\u636e\u6e902\u67e5\u8be2, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(800);\n            return "\u6570\u636e\u6e902\u7684\u7ed3\u679c";\n        }, getExecutor());\n        \n        CompletableFuture<String> source3 = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6570\u636e\u6e903\u67e5\u8be2, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1200);\n            return "\u6570\u636e\u6e903\u7684\u7ed3\u679c";\n        }, getExecutor());\n        \n        // \u8fd4\u56de\u6700\u5feb\u5b8c\u6210\u7684\u7ed3\u679c\n        return CompletableFuture.anyOf(source1, source2, source3)\n            .thenApply(result -> {\n                logger.info("\u6700\u5feb\u8fd4\u56de\u7684\u7ed3\u679c: {}", result);\n                return (String) result;\n            });\n    }\n    \n    // ==================== \u56db\u3001\u5f02\u5e38\u5904\u7406 ====================\n    \n    /**\n     * \u793a\u4f8b12: \u4f7f\u7528 exceptionally \u5904\u7406\u5f02\u5e38\n     * \n     * exceptionally \u6355\u83b7\u5f02\u5e38\u5e76\u8fd4\u56de\u9ed8\u8ba4\u503c\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u5f02\u5e38\u65f6\u8fd4\u56de\u515c\u5e95\u6570\u636e\n     */\n    public CompletableFuture<String> handleExceptionWithExceptionally() {\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6267\u884c\u53ef\u80fd\u5931\u8d25\u7684\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(500);\n            // \u6a21\u62df\u5f02\u5e38\n            if (Math.random() > 0.5) {\n                throw new RuntimeException("\u6a21\u62df\u4e1a\u52a1\u5f02\u5e38");\n            }\n            return "\u6b63\u5e38\u7ed3\u679c";\n        }, getExecutor())\n        .exceptionally(ex -> {\n            logger.error("\u4efb\u52a1\u6267\u884c\u5931\u8d25\uff0c\u8fd4\u56de\u9ed8\u8ba4\u503c: {}", ex.getMessage());\n            return "\u9ed8\u8ba4\u503c";\n        });\n    }\n    \n    /**\n     * \u793a\u4f8b13: \u4f7f\u7528 handle \u540c\u65f6\u5904\u7406\u6b63\u5e38\u7ed3\u679c\u548c\u5f02\u5e38\n     * \n     * handle \u65e0\u8bba\u6210\u529f\u8fd8\u662f\u5931\u8d25\u90fd\u4f1a\u6267\u884c\n     * \u53ef\u4ee5\u83b7\u53d6\u7ed3\u679c\u548c\u5f02\u5e38\uff0c\u8fd4\u56de\u65b0\u503c\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u9700\u8981\u7edf\u4e00\u5904\u7406\u6210\u529f\u548c\u5931\u8d25\u60c5\u51b5\n     */\n    public CompletableFuture<String> handleWithHandle() {\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6267\u884c\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            if (Math.random() > 0.5) {\n                throw new RuntimeException("\u4efb\u52a1\u5931\u8d25");\n            }\n            return "\u4efb\u52a1\u6210\u529f";\n        }, getExecutor())\n        .handle((result, ex) -> {\n            if (ex != null) {\n                logger.error("\u4efb\u52a1\u6267\u884c\u5f02\u5e38: {}", ex.getMessage());\n                return "\u5f02\u5e38\u5904\u7406: " + ex.getMessage();\n            } else {\n                logger.info("\u4efb\u52a1\u6267\u884c\u6210\u529f: {}", result);\n                return "\u6210\u529f\u5904\u7406: " + result;\n            }\n        });\n    }\n    \n    /**\n     * \u793a\u4f8b14: \u4f7f\u7528 whenComplete \u6267\u884c\u5b8c\u6210\u540e\u7684\u56de\u8c03\uff08\u4e0d\u6539\u53d8\u7ed3\u679c\uff09\n     * \n     * whenComplete \u5728\u4efb\u52a1\u5b8c\u6210\u540e\u6267\u884c\uff0c\u4e0d\u6539\u53d8\u7ed3\u679c\n     * \u53ef\u4ee5\u83b7\u53d6\u7ed3\u679c\u548c\u5f02\u5e38\uff0c\u4f46\u4e0d\u80fd\u8fd4\u56de\u65b0\u503c\n     * \n     * \u4f7f\u7528\u573a\u666f\uff1a\u8bb0\u5f55\u65e5\u5fd7\u3001\u76d1\u63a7\u7edf\u8ba1\u3001\u8d44\u6e90\u6e05\u7406\n     */\n    public CompletableFuture<String> handleWithWhenComplete() {\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6267\u884c\u4e1a\u52a1\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            return "\u4e1a\u52a1\u7ed3\u679c";\n        }, getExecutor())\n        .whenComplete((result, ex) -> {\n            if (ex != null) {\n                logger.error("\u4efb\u52a1\u6267\u884c\u5931\u8d25\uff0c\u8bb0\u5f55\u65e5\u5fd7: {}", ex.getMessage());\n            } else {\n                logger.info("\u4efb\u52a1\u6267\u884c\u6210\u529f\uff0c\u8bb0\u5f55\u65e5\u5fd7: {}", result);\n            }\n        });\n    }\n    \n    // ==================== \u4e94\u3001\u8d85\u65f6\u63a7\u5236 ====================\n    \n    /**\n     * \u793a\u4f8b15: \u4f7f\u7528\u8d85\u65f6\u63a7\u5236\uff08\u517c\u5bb9 Java 8\uff09\n     *\n     * \u901a\u8fc7 CompletableFuture.anyOf \u5b9e\u73b0\u8d85\u65f6\u63a7\u5236\n     *\n     * \u4f7f\u7528\u573a\u666f\uff1a\u9632\u6b62\u4efb\u52a1\u6267\u884c\u65f6\u95f4\u8fc7\u957f\n     */\n    public CompletableFuture<String> handleTimeout() {\n        CompletableFuture<String> taskFuture = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6267\u884c\u8017\u65f6\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(3000); // \u6a21\u62df\u8017\u65f63\u79d2\n            return "\u4efb\u52a1\u7ed3\u679c";\n        }, getExecutor());\n\n        // \u521b\u5efa\u8d85\u65f6Future\n        CompletableFuture<String> timeoutFuture = new CompletableFuture<>();\n        ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);\n        scheduler.schedule(() -> {\n            timeoutFuture.completeExceptionally(new TimeoutException("\u4efb\u52a1\u6267\u884c\u8d85\u65f6"));\n            scheduler.shutdown();\n        }, 2, TimeUnit.SECONDS);\n\n        // \u8fd4\u56de\u6700\u5148\u5b8c\u6210\u7684\n        return CompletableFuture.anyOf(taskFuture, timeoutFuture)\n            .thenApply(result -> (String) result)\n            .exceptionally(ex -> {\n                logger.error("\u4efb\u52a1\u8d85\u65f6: {}", ex.getMessage());\n                return "\u8d85\u65f6\u9ed8\u8ba4\u503c";\n            });\n    }\n\n    /**\n     * \u793a\u4f8b16: \u8d85\u65f6\u8fd4\u56de\u9ed8\u8ba4\u503c\uff08\u517c\u5bb9 Java 8\uff09\n     *\n     * \u8d85\u65f6\u540e\u8fd4\u56de\u9ed8\u8ba4\u503c\uff0c\u4e0d\u629b\u5f02\u5e38\n     *\n     * \u4f7f\u7528\u573a\u666f\uff1a\u8d85\u65f6\u540e\u4f7f\u7528\u515c\u5e95\u6570\u636e\n     */\n    public CompletableFuture<String> handleTimeoutWithDefault() {\n        CompletableFuture<String> taskFuture = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6267\u884c\u4efb\u52a1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(3000);\n            return "\u6b63\u5e38\u7ed3\u679c";\n        }, getExecutor());\n\n        // \u521b\u5efa\u8d85\u65f6Future\uff0c\u8d85\u65f6\u540e\u5b8c\u6210\u5e76\u8fd4\u56de\u9ed8\u8ba4\u503c\n        CompletableFuture<String> timeoutFuture = new CompletableFuture<>();\n        ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);\n        scheduler.schedule(() -> {\n            timeoutFuture.complete("\u8d85\u65f6\u9ed8\u8ba4\u7ed3\u679c");\n            scheduler.shutdown();\n        }, 2, TimeUnit.SECONDS);\n\n        // \u8fd4\u56de\u6700\u5148\u5b8c\u6210\u7684\n        return CompletableFuture.anyOf(taskFuture, timeoutFuture)\n            .thenApply(result -> {\n                logger.info("\u8fd4\u56de\u7ed3\u679c: {}", result);\n                return (String) result;\n            });\n    }\n    \n    // ==================== \u516d\u3001\u5b9e\u6218\u7efc\u5408\u6848\u4f8b ====================\n    \n    /**\n     * \u793a\u4f8b17: \u590d\u6742\u4e1a\u52a1\u573a\u666f - \u8ba2\u5355\u5904\u7406\u6d41\u7a0b\n     * \n     * \u573a\u666f\uff1a\u521b\u5efa\u8ba2\u5355\u9700\u8981\uff1a\n     * 1. \u6821\u9a8c\u5e93\u5b58\uff08\u5e76\u884c\uff09\n     * 2. \u6821\u9a8c\u7528\u6237\u79ef\u5206\uff08\u5e76\u884c\uff09\n     * 3. \u521b\u5efa\u8ba2\u5355\uff08\u4f9d\u8d561\u30012\uff09\n     * 4. \u6263\u51cf\u5e93\u5b58\uff08\u4f9d\u8d563\uff09\n     * 5. \u6263\u51cf\u79ef\u5206\uff08\u4f9d\u8d563\uff09\n     * 6. \u53d1\u9001\u901a\u77e5\uff08\u4f9d\u8d563\uff09\n     */\n    public CompletableFuture<String> complexOrderProcess(Long userId, Long productId, Integer quantity) {\n        logger.info("\u5f00\u59cb\u5904\u7406\u8ba2\u5355\uff1a\u7528\u6237={}, \u5546\u54c1={}, \u6570\u91cf={}", userId, productId, quantity);\n        \n        // \u6b65\u9aa41\uff1a\u5e76\u884c\u6821\u9a8c\u5e93\u5b58\u548c\u79ef\u5206\n        CompletableFuture<Boolean> checkInventory = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6821\u9a8c\u5e93\u5b58, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(500);\n            return true; // \u5e93\u5b58\u5145\u8db3\n        }, getExecutor());\n        \n        CompletableFuture<Boolean> checkPoints = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u6821\u9a8c\u79ef\u5206, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(600);\n            return true; // \u79ef\u5206\u5145\u8db3\n        }, getExecutor());\n        \n        // \u6b65\u9aa42\uff1a\u7b49\u5f85\u6821\u9a8c\u5b8c\u6210\uff0c\u521b\u5efa\u8ba2\u5355\n        return CompletableFuture.allOf(checkInventory, checkPoints)\n            .thenCompose(v -> {\n                if (!checkInventory.join() || !checkPoints.join()) {\n                    return CompletableFuture.completedFuture("\u8ba2\u5355\u521b\u5efa\u5931\u8d25\uff1a\u5e93\u5b58\u6216\u79ef\u5206\u4e0d\u8db3");\n                }\n                \n                return CompletableFuture.supplyAsync(() -> {\n                    logger.info("\u521b\u5efa\u8ba2\u5355, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n                    sleep(800);\n                    return "ORDER-" + System.currentTimeMillis();\n                }, getExecutor());\n            })\n            // \u6b65\u9aa43\uff1a\u5e76\u884c\u6263\u51cf\u5e93\u5b58\u548c\u79ef\u5206\n            .thenCompose(orderId -> {\n                if (orderId.startsWith("\u8ba2\u5355\u521b\u5efa\u5931\u8d25")) {\n                    return CompletableFuture.completedFuture(orderId);\n                }\n                \n                CompletableFuture<Void> deductInventory = CompletableFuture.runAsync(() -> {\n                    logger.info("\u6263\u51cf\u5e93\u5b58\uff0c\u8ba2\u5355: {}, \u7ebf\u7a0b: {}", orderId, Thread.currentThread().getName());\n                    sleep(400);\n                }, getExecutor());\n                \n                CompletableFuture<Void> deductPoints = CompletableFuture.runAsync(() -> {\n                    logger.info("\u6263\u51cf\u79ef\u5206\uff0c\u8ba2\u5355: {}, \u7ebf\u7a0b: {}", orderId, Thread.currentThread().getName());\n                    sleep(500);\n                }, getExecutor());\n                \n                return CompletableFuture.allOf(deductInventory, deductPoints)\n                    .thenApply(v -> orderId);\n            })\n            // \u6b65\u9aa44\uff1a\u53d1\u9001\u901a\u77e5\n            .thenApply(orderId -> {\n                if (!orderId.startsWith("\u8ba2\u5355\u521b\u5efa\u5931\u8d25")) {\n                    CompletableFuture.runAsync(() -> {\n                        logger.info("\u53d1\u9001\u8ba2\u5355\u901a\u77e5\uff0c\u8ba2\u5355: {}, \u7ebf\u7a0b: {}", orderId, Thread.currentThread().getName());\n                    }, getExecutor());\n                }\n                return orderId;\n            })\n            // \u6b65\u9aa45\uff1a\u5f02\u5e38\u5904\u7406\n            .exceptionally(ex -> {\n                logger.error("\u8ba2\u5355\u5904\u7406\u5931\u8d25: {}", ex.getMessage(), ex);\n                return "\u8ba2\u5355\u5904\u7406\u5f02\u5e38: " + ex.getMessage();\n            })\n            // \u6b65\u9aa46\uff1a\u5b8c\u6210\u56de\u8c03\n            .whenComplete((result, ex) -> {\n                if (ex == null) {\n                    logger.info("\u8ba2\u5355\u5904\u7406\u5b8c\u6210: {}", result);\n                }\n            });\n    }\n    \n    /**\n     * \u793a\u4f8b18: \u6279\u91cf\u6570\u636e\u5904\u7406 - \u5206\u7247\u5e76\u884c\u5904\u7406\n     * \n     * \u573a\u666f\uff1a\u5904\u740610000\u6761\u6570\u636e\uff0c\u520610\u6279\uff0c\u6bcf\u62791000\u6761\u5e76\u884c\u5904\u7406\n     */\n    public CompletableFuture<Integer> batchProcess(List<Long> dataIds) {\n        logger.info("\u5f00\u59cb\u6279\u91cf\u5904\u7406\uff0c\u603b\u6570: {}", dataIds.size());\n        \n        // \u5206\u7247\uff1a\u6bcf\u62791000\u6761\n        int batchSize = 1000;\n        List<List<Long>> batches = partition(dataIds, batchSize);\n        \n        // \u4e3a\u6bcf\u4e00\u6279\u521b\u5efa\u5f02\u6b65\u4efb\u52a1\n        List<CompletableFuture<Integer>> futures = batches.stream()\n            .map(batch -> CompletableFuture.supplyAsync(() -> {\n                logger.info("\u5904\u7406\u6279\u6b21\uff0c\u6570\u91cf: {}, \u7ebf\u7a0b: {}", batch.size(), Thread.currentThread().getName());\n                sleep(1000); // \u6a21\u62df\u5904\u7406\n                return batch.size();\n            }, getExecutor()))\n            .collect(Collectors.toList());\n        \n        // \u7b49\u5f85\u6240\u6709\u6279\u6b21\u5b8c\u6210\uff0c\u6c47\u603b\u7ed3\u679c\n        return CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]))\n            .thenApply(v -> {\n                int total = futures.stream()\n                    .mapToInt(CompletableFuture::join)\n                    .sum();\n                logger.info("\u6279\u91cf\u5904\u7406\u5b8c\u6210\uff0c\u603b\u5904\u7406\u6570: {}", total);\n                return total;\n            })\n            .exceptionally(ex -> {\n                logger.error("\u6279\u91cf\u5904\u7406\u5931\u8d25: {}", ex.getMessage(), ex);\n                return 0;\n            });\n    }\n    \n    /**\n     * \u793a\u4f8b19: \u591a\u6570\u636e\u6e90\u805a\u5408\u67e5\u8be2\n     * \n     * \u573a\u666f\uff1a\u540c\u65f6\u67e5\u8be2\u7528\u6237\u4fe1\u606f\u3001\u8ba2\u5355\u5217\u8868\u3001\u6536\u85cf\u5546\u54c1\uff0c\u7ec4\u88c5\u6210\u9996\u9875\u6570\u636e\n     */\n    public CompletableFuture<String> aggregateUserData(Long userId) {\n        logger.info("\u805a\u5408\u67e5\u8be2\u7528\u6237\u6570\u636e: {}", userId);\n        \n        // \u5e76\u884c\u67e5\u8be2\u591a\u4e2a\u6570\u636e\u6e90\n        CompletableFuture<String> userInfo = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u67e5\u8be2\u7528\u6237\u4fe1\u606f, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(800);\n            return "\u7528\u6237\u4fe1\u606f";\n        }, getExecutor());\n        \n        CompletableFuture<String> orderList = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u67e5\u8be2\u8ba2\u5355\u5217\u8868, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1200);\n            return "\u8ba2\u5355\u5217\u8868";\n        }, getExecutor());\n        \n        CompletableFuture<String> favorites = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u67e5\u8be2\u6536\u85cf\u5546\u54c1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(600);\n            return "\u6536\u85cf\u5546\u54c1";\n        }, getExecutor());\n        \n        CompletableFuture<String> recommendations = CompletableFuture.supplyAsync(() -> {\n            logger.info("\u67e5\u8be2\u63a8\u8350\u5546\u54c1, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(1000);\n            return "\u63a8\u8350\u5546\u54c1";\n        }, getExecutor());\n        \n        // \u805a\u5408\u6240\u6709\u7ed3\u679c\n        return CompletableFuture.allOf(userInfo, orderList, favorites, recommendations)\n            .thenApply(v -> {\n                String result = String.format("\u9996\u9875\u6570\u636e: {\u7528\u6237: %s, \u8ba2\u5355: %s, \u6536\u85cf: %s, \u63a8\u8350: %s}",\n                    userInfo.join(), orderList.join(), favorites.join(), recommendations.join());\n                logger.info("\u6570\u636e\u805a\u5408\u5b8c\u6210");\n                return result;\n            })\n            .exceptionally(ex -> {\n                logger.error("\u6570\u636e\u805a\u5408\u5931\u8d25: {}", ex.getMessage());\n                return "\u6570\u636e\u52a0\u8f7d\u5931\u8d25";\n            });\n    }\n    \n    /**\n     * \u793a\u4f8b20: \u7f13\u5b58\u7a7f\u900f\u9632\u62a4 - \u5e76\u53d1\u8bf7\u6c42\u5408\u5e76\n     * \n     * \u573a\u666f\uff1a\u591a\u4e2a\u8bf7\u6c42\u540c\u65f6\u67e5\u8be2\u540c\u4e00\u4e2akey\uff0c\u53ea\u6267\u884c\u4e00\u6b21\u6570\u636e\u5e93\u67e5\u8be2\n     */\n    public CompletableFuture<Object> getDataWithCache(String key) {\n        logger.info("\u67e5\u8be2\u6570\u636e\uff0ckey: {}", key);\n        \n        // \u6a21\u62df\uff1a\u5148\u67e5\u7f13\u5b58\n        return CompletableFuture.supplyAsync(() -> {\n            logger.info("\u67e5\u8be2\u7f13\u5b58, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n            sleep(100);\n            return null; // \u7f13\u5b58\u672a\u547d\u4e2d\n        }, getExecutor())\n        .thenCompose(cacheData -> {\n            if (cacheData != null) {\n                logger.info("\u7f13\u5b58\u547d\u4e2d: {}", cacheData);\n                return CompletableFuture.completedFuture(cacheData);\n            }\n            \n            // \u7f13\u5b58\u672a\u547d\u4e2d\uff0c\u67e5\u8be2\u6570\u636e\u5e93\n            return CompletableFuture.supplyAsync(() -> {\n                logger.info("\u7f13\u5b58\u672a\u547d\u4e2d\uff0c\u67e5\u8be2\u6570\u636e\u5e93, \u7ebf\u7a0b: {}", Thread.currentThread().getName());\n                sleep(1500); // \u6a21\u62df\u6570\u636e\u5e93\u67e5\u8be2\n                String dbData = "DB\u6570\u636e-" + key;\n                \n                // \u5f02\u6b65\u66f4\u65b0\u7f13\u5b58\uff08\u4e0d\u963b\u585e\u4e3b\u6d41\u7a0b\uff09\n                CompletableFuture.runAsync(() -> {\n                    logger.info("\u66f4\u65b0\u7f13\u5b58, key: {}", key);\n                    sleep(200);\n                }, getExecutor());\n                \n                return dbData;\n            }, getExecutor());\n        })\n        .exceptionally(ex -> {\n            logger.error("\u67e5\u8be2\u5931\u8d25: {}", ex.getMessage());\n            return "\u9ed8\u8ba4\u503c";\n        });\n    }\n    \n    // ==================== \u5de5\u5177\u65b9\u6cd5 ====================\n    \n    /**\n     * \u7761\u7720\u6307\u5b9a\u6beb\u79d2\u6570\n     */\n    private void sleep(long millis) {\n        try {\n            Thread.sleep(millis);\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n            logger.error("\u7ebf\u7a0b\u88ab\u4e2d\u65ad", e);\n        }\n    }\n    \n    /**\n     * \u5c06\u5217\u8868\u5206\u7247\n     * \u4fee\u590d\uff1a\u4f7f\u7528\u7d22\u5f15\u907f\u514d indexOf \u6027\u80fd\u95ee\u9898\n     */\n    private <T> List<List<T>> partition(List<T> list, int batchSize) {\n        if (list == null || list.isEmpty() || batchSize <= 0) {\n            return new ArrayList<>();\n        }\n        \n        List<List<T>> result = new ArrayList<>();\n        int size = list.size();\n        for (int i = 0; i < size; i += batchSize) {\n            result.add(list.subList(i, Math.min(i + batchSize, size)));\n        }\n        return result;\n    }\n}\n\n'})})]})}function i(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,u.jsx)(n,{...e,children:(0,u.jsx)(p,{...e})}):p(e)}},8453(e,n,r){r.d(n,{R:()=>o,x:()=>a});var t=r(6540);const u={},l=t.createContext(u);function o(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(u):e.components||u:o(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);