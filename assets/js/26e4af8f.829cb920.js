"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1259],{7788(e,n,t){t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>p});const a=JSON.parse('{"id":"tencent/2026-01-04-tencent-weapp login","title":"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u767b\u5f55","description":"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u767b\u5f55","source":"@site/javadoc/tencent/2026-01-04-tencent-weapp login.md","sourceDirName":"tencent","slug":"/tencent/java-tencent-weapp-login","permalink":"/docs/javadoc/tencent/java-tencent-weapp-login","draft":false,"unlisted":false,"editUrl":"https://github.com/LiangHChao/docs/edit/master/javadoc/tencent/2026-01-04-tencent-weapp login.md","tags":[{"inline":true,"label":"java","permalink":"/docs/javadoc/tags/java"},{"inline":true,"label":"tencent","permalink":"/docs/javadoc/tags/tencent"}],"version":"current","frontMatter":{"slug":"java-tencent-weapp-login","title":"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u767b\u5f55","authors":["lianghchao"],"tags":["java","tencent"]},"sidebar":"javaSidebar","previous":{"title":"\u817e\u8baf\u77ed\u4fe1","permalink":"/docs/javadoc/tencent/java-tencent-sms"},"next":{"title":"\u5fae\u670d\u52a1\u76f8\u5173","permalink":"/docs/javadoc/category/\u5fae\u670d\u52a1\u76f8\u5173"}}');var r=t(4848),s=t(8453);const o={slug:"java-tencent-weapp-login",title:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u767b\u5f55",authors:["lianghchao"],tags:["java","tencent"]},c=void 0,i={},p=[{value:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u767b\u5f55",id:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u767b\u5f55",level:2}];function l(e){const n={code:"code",h2:"h2",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u767b\u5f55",children:"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u767b\u5f55"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'public class WeChatService {\n\n    private static final String JS_CODE_2_SESSION_URL = "https://api.weixin.qq.com/sns/jscode2session";\n\n    /**\n     * \u901a\u8fc7\u5c0f\u7a0b\u5e8f code \u6362\u53d6 openid \u548c session_key\n     * \u5fae\u4fe1\u516c\u4f17\u5e73\u53f0-\u7ba1\u7406-\u5f00\u53d1\u7ba1\u7406-\u5f00\u53d1\u8bbe\u7f6e-AppID\uff08\u5c0f\u7a0b\u5e8f\uff09\u3001AppSecret\uff08\u5c0f\u7a0b\u5e8f\uff09\n     *\n     * @param appId     \u5c0f\u7a0b\u5e8f appId\n     * @param appSecret \u5c0f\u7a0b\u5e8f appSecret\n     * @param jsCode    \u524d\u7aef\u4f20\u6765\u7684\u4e34\u65f6\u767b\u5f55\u51ed\u8bc1 code\n     * @return \u8fd4\u56de\u5305\u542b openid\u3001session_key \u7b49\u7684 JSON \u5bf9\u8c61\uff0c\u82e5\u5931\u8d25\u8fd4\u56de null \u6216\u629b\u5f02\u5e38\uff08\u53ef\u6839\u636e\u9700\u6c42\u8c03\u6574\uff09\n     */\n    public JSONObject jsCode2Session(String appId, String appSecret, String jsCode) {\n        Map<String, Object> paramMap = new HashMap<>();\n        paramMap.put("appid", appId);\n        paramMap.put("secret", appSecret);\n        paramMap.put("js_code", jsCode);\n        paramMap.put("grant_type", "authorization_code"); // \u56fa\u5b9a\u503c\n\n        try {\n            String resultStr = HttpUtil.get(JS_CODE_2_SESSION_URL, paramMap);\n            JSONObject result = JSONUtil.parseObj(resultStr);\n\n            // \u68c0\u67e5\u662f\u5426\u8fd4\u56de\u9519\u8bef\n            if (result.containsKey("errcode") && result.getInt("errcode") != 0) {\n                System.err.println("\u5fae\u4fe1 jscode2session \u5931\u8d25: " + result.getStr("errmsg"));\n                return null; // \u6216\u629b\u51fa\u81ea\u5b9a\u4e49\u5f02\u5e38\n            }\n\n            return result; // \u6210\u529f\u65f6\u5305\u542b openid, session_key, unionid\uff08\u5982\u6709\uff09\n        } catch (Exception e) {\n            e.printStackTrace();\n            return null;\n        }\n    }\n\n    // \u793a\u4f8b main \u65b9\u6cd5\u6d4b\u8bd5\n    public static void main(String[] args) {\n        WeChatService service = new WeChatService();\n        String appId = "your-appid";\n        String appSecret = "your-appsecret";\n        String jsCode = "your-js-code-from-frontend";\n\n        JSONObject response = service.jsCode2Session(appId, appSecret, jsCode);\n        if (response != null) {\n            System.out.println("openid: " + response.getStr("openid"));\n            System.out.println("session_key: " + response.getStr("session_key"));\n        }\n    }\n}\n\n'})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453(e,n,t){t.d(n,{R:()=>o,x:()=>c});var a=t(6540);const r={},s=a.createContext(r);function o(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);